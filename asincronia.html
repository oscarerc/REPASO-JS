<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asincronia en JS</title>
</head>
<body>
    <h1>Asincronia ENN js</h1>

<script>
// recibe una callback con un tiempo para ejecutar la accion
    // setTimeout(()=>{
    //     console.log("EJECUTADO");
    //     new Date().toLocateTimeString();
    // },1000)

    // CANCELAR UN TIMEOUT PERO DEBE ESTAR GUARDADO EN UN VARIABLE
    // clearTimeout();

    // setInterval(() => {
    //     // se ejecuta cada cierto tiempo
    // }, interval);
    // dar la hora en un formato humanamente entendible
    // new Date().toLocateTimeString();


    //--------------------------------------------------
        // ASINCRONIA
        // JS= SINGLE THREAD Y MULTI THREAD
        // OPERACIONES DE CPU Y OPERACIONES DE I/o (ENTRADAS)
        //OPERACIONES CONCURRENTES = CUANDO DOS O O MAS TARDES PROGRESAN SIMULTANEAMENTE-PUEDENE INICIAR DE DISTINTA FORMA //O PARALELAS=ARRANCAN A LA VEZ
        //operaciones sincronas y asincronas=cuando tendra lugar la respuesta
        // SINCRONA: LA RESPUESTA TENDRA LUGAR EN TIEMPO INMEDIATO-BLOQUENATE
        // ASINCRONA: LA RESPUESTA SUCEDE EN UN FUTURO NO SE ESPECIFICA CUANDO VA A LLEGAR LA RESPUESTA SUELTA EL CONTROL-NO BLOQUEANTE

        // JS ES UN MODELO ASINCRONO Y NO BLOQUEANTE CON UN LOOP DE EVENTOS IMPLEMENTENTADO EN UNSOLO HILO
        // (SINGLE THREAD) PARA OPERACIONES DE ENTRADA Y SALIDA (INPUT/OUTPUT)

        // EJEMPLOS
        //CODIGO SINCRONO BLOQUEANTE
        // (()=>{
        //     console.log("CODIGO SINCRONO");
        //     console.log("INICIO");

        //     function dos(){
        //         console.log("DOS");
        //     }


        //     function uno(){
        //         console.log("UNO");
        //         dos();
        //         console.log("TRES");
        //     }
        //     uno();
        //     console.log("FIN");
        // })();

        //CODIGO ASINCRONO BLOQUEANTE
        // (()=>{
        //     console.log("CODIGO asincrono");
        //     console.log("INICIO");

        //     function dos(){
        //         setTimeout(function(){
        //             console.log("DOS");
        //         },5000);
        //     }


        //     function uno(){
        //         setTimeout(function(){
        //             console.log("UNO");
        //         },0)
        //         dos();
        //         console.log("TRES");
        //     }
        //     uno();
        //     console.log("FIN");
        // })();

        //CALLBACKS
        // FUNCION QUE SE EJECUTA DESPUES DE QUE OTRA LO HAGA
        // MECANISMO PARA CONTROLAR LA ASINCRONIA


    /* function cuadradoCallback(value, callback) {
      setTimeout(() => {
        callback(value, value * value);
      }, 0 | Math.random() * 1000);
    }
    cuadradoCallback(0, (value, result) => {
      console.log("Inicia Callback");
      console.log(`Callback: ${value}, ${result}`);
      cuadradoCallback(1, (value, result) => {
        console.log(`Callback: ${value}, ${result}`);
        cuadradoCallback(2, (value, result) => {
          console.log(`Callback: ${value}, ${result}`);
          cuadradoCallback(3, (value, result) => {
            console.log(`Callback: ${value}, ${result}`);
            cuadradoCallback(4, (value, result) => {
              console.log(`Callback: ${value}, ${result}`);
              cuadradoCallback(5, (value, result) => {
                console.log(`Callback: ${value}, ${result}`);
                console.log("Fin Callback");
                console.log("Callback Hell !!!!!ðŸ˜ˆðŸ¤˜");
                console.log("http://callbackhell.com/");
              });
            });
          });
        });
      });
    }); 
*/

    // PROMESAS
// MANEJAR ASINCRONIA THE. = SE EJECUTA DESPUES DE DAR RESULTADO A LA FUNCION
// CATCH =CAPTURA EL ERROR RESULTANTE

    //  function cuadradoPromise(value) {
    //   if (typeof value !== "number") {
    //     return Promise.reject(`Error, el valor " ${value} " ingresado no es un nÃºmero`);
    //   }
    //   return new Promise((resolve, reject) => {
    //     setTimeout(() => {
    //       resolve({
    //         value,
    //         result: value * value
    //       });
    //     }, 0 | Math.random() * 1000);
    //   });
    // }

    // cuadradoPromise(0)
    //       .then(obj => {
    //         //console.log(obj);
    //         console.log('Inicio Promise');
    //         console.log(`Promise: ${obj.value}, ${obj.result}`);
    //         return cuadradoPromise(1);
    //       })
    //       .then(obj => {
    //         console.log(`Promise: ${obj.value}, ${obj.result}`);
    //         return cuadradoPromise(2);
    //       })
    //       .then(obj => {
    //         console.log(`Promise: ${obj.value}, ${obj.result}`);
    //         return cuadradoPromise(3);
    //       })
    //       .then(obj => {
    //         console.log(`Promise: ${obj.value}, ${obj.result}`);
    //         return cuadradoPromise("4");
    //       })
    //       .then(obj => {
    //         console.log(`Promise: ${obj.value}, ${obj.result}`);
    //         return cuadradoPromise(5);
    //       })
    //       .then(obj => {
    //         console.log(`Promise: ${obj.value}, ${obj.result}`);
    //         console.log('Fin Promise');
    //       })
    //       .catch(err => console.error(err));  

    //ASYNC AWAIT
    // ASYNC= FUNCION QUE PUEDE HACER COSAS ASINCRONAS ESPERANDO INSTRUCCIONES HACIENDO USO DEL AWAIT



      function cuadradoPromise(value) {
       if (typeof value !== "number") {
         return Promise.reject(`Error, el valor " ${value} " ingresado no es un nÃºmero`);
       }
       return new Promise((resolve, reject) => {
         setTimeout(() => {
           resolve({
             value,
             result: value * value
           });
         }, 0 | Math.random() * 1000);
       });
     }
    //  DE FORMA DECLARADA
    async function funionAsincronaDeclarada(){
      try {
          console.log("INICIO DE LA FUNCION ASINCRONA");
        // EL AWAIT OBLIGA A QUE PRIMERO SE EJECUTE LA LINEA ANTES DE PASAR A LAA SIGUIENTE
          let obj = await cuadradoPromise(0);
          console.log(`Async function ${obj.value},${obj.result}`)

          obj =await cuadradoPromise(1);
          console.log(`Async function ${obj.value},${obj.result}`)

      } catch (error) {
        console.log(error);
      }
    }

    // funionAsincronaDeclarada();

    // DE FORMA EXPRESADA
    const funcionAsincronaExpresada = async () => {
      try {
        console.log('Inicio Async Function');
        let obj = await cuadradoPromise(6);
        console.log(`Async Function: ${obj.value}, ${obj.result}`);
        obj = await cuadradoPromise(7);
        console.log(`Async Function: ${obj.value}, ${obj.result}`);
        obj = await cuadradoPromise(8);
        console.log(`Async Function: ${obj.value}, ${obj.result}`);
        obj = await cuadradoPromise("9");
        console.log(`Async Function: ${obj.value}, ${obj.result}`);
        obj = await cuadradoPromise(10);
        console.log(`Async Function: ${obj.value}, ${obj.result}`);
        console.log('Fin Async Function');
      } catch (err) {
        console.error(err)
      }
    }

    // funcionAsincronaExpresada();


</script>

</body>
</html>